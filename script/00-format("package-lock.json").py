#!/usr/bin/env python
# initially modified at 07:14 AM on Sat 06 Jan 2024
#      last modified at ??:?? ?M on ??? ?? ??? 2024
# Description:
#   Find out if some package-lock.json file has more than 2 lines.
#   > at 08:42 AM on Sat 06 Jan 2024
#
import os  # 7:16 AM Sat 6 Jan 2024
import sys # 8:12 AM Sat 6 Jan 2024
#   clear; git hook run pre-commit

rejectCommit = False

for path, _, subpaths in os.walk('.'):
	for subpath in subpaths:
		if not subpath.endswith("package-lock.json"):
			continue

		target = f"{path}/{subpath}"
		with open(target, "r") as file:
			if file.read().count("\n") == 1:
				print(f"✔️ {target} contains the exact amount of lines!")
			else:
				rejectCommit = True
				print(f"❌ {target} contains too many lines!")

if rejectCommit:
	exit(1)

try:
	print(os.environ["GIT_DIR"])
	print(os.environ["GIT_WORK_TREE"])
except:
	exit(1)
